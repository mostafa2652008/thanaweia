<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#1e293b">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="THANAWEIA AMMA">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="screen-orientation" content="any">
    <title>MOSTAFA THANAWEIA AMMA</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cdefs%3E%3ClinearGradient id='grad' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%23667eea;stop-opacity:1' /%3E%3Cstop offset='100%25' style='stop-color:%23764ba2;stop-opacity:1' /%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='100' height='100' rx='20' fill='url(%23grad)'/%3E%3Ctext x='50' y='70' font-size='60' text-anchor='middle' fill='white' font-family='Arial, sans-serif' font-weight='bold'%3E๐%3C/text%3E%3C/svg%3E">
    <link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 180 180'%3E%3Cdefs%3E%3ClinearGradient id='grad' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%23667eea;stop-opacity:1' /%3E%3Cstop offset='100%25' style='stop-color:%23764ba2;stop-opacity:1' /%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='180' height='180' rx='40' fill='url(%23grad)'/%3E%3Ctext x='90' y='125' font-size='100' text-anchor='middle' fill='white' font-family='Arial, sans-serif' font-weight='bold'%3E๐%3C/text%3E%3C/svg%3E">
    <link rel="manifest" href="data:application/json;charset=utf-8,%7B%22name%22%3A%22MOSTAFA%20THANAWEIA%20AMMA%22%2C%22short_name%22%3A%22THANAWEIA%22%2C%22description%22%3A%22%D9%86%D8%B8%D8%A7%D9%85%20%D8%A7%D9%84%D9%85%D8%B1%D8%A7%D8%AC%D8%B9%D8%A9%20%D8%A7%D9%84%D8%B0%D9%83%D9%8A%D8%A9%22%2C%22start_url%22%3A%22.%2F%22%2C%22display%22%3A%22standalone%22%2C%22background_color%22%3A%22%230f172a%22%2C%22theme_color%22%3A%22%231e293b%22%2C%22orientation%22%3A%22any%22%2C%22icons%22%3A%5B%7B%22src%22%3A%22data%3Aimage%2Fsvg%2Bxml%2C%253Csvg%2520xmlns%253D%2527http%253A%252F%252Fwww.w3.org%252F2000%252Fsvg%2527%2520viewBox%253D%25270%25200%2520512%2520512%2527%253E%253Cdefs%253E%253ClinearGradient%2520id%253D%2527grad%2527%2520x1%253D%25270%252525%2527%2520y1%253D%25270%252525%2527%2520x2%253D%2527100%252525%2527%2520y2%253D%2527100%252525%2527%253E%253Cstop%2520offset%253D%25270%252525%2527%2520style%253D%2527stop-color%253A%2523667eea%253Bstop-opacity%253A1%2527%2520%252F%253E%253Cstop%2520offset%253D%2527100%252525%2527%2520style%253D%2527stop-color%253A%2523764ba2%253Bstop-opacity%253A1%2527%2520%252F%253E%253C%252FlinearGradient%253E%253C%252Fdefs%253E%253Crect%2520width%253D%2527512%2527%2520height%253D%2527512%2527%2520rx%253D%252790%2527%2520fill%253D%2527url%2528%2523grad%2529%2527%252F%253E%253Ctext%2520x%253D%2527256%2527%2520y%253D%2527370%2527%2520font-size%253D%2527320%2527%2520text-anchor%253D%2527middle%2527%2520fill%253D%2527white%2527%2520font-family%253D%2527Arial%252C%2520sans-serif%2527%2520font-weight%253D%2527bold%2527%253E%25F0%259F%2593%259A%253C%252Ftext%253E%253C%252Fsvg%253E%22%2C%22sizes%22%3A%22512x512%22%2C%22type%22%3A%22image%2Fsvg%2Bxml%22%2C%22purpose%22%3A%22any%20maskable%22%7D%5D%7D">
    <link rel="stylesheet" href="style.css">


</head>
<body>
    <!-- Auth Screen -->
    <div id="authScreen" class="auth-container">
        <div class="auth-box">
            <div class="logo">
                <h1>MOSTAFA THANAWEIA AMMA</h1>
                <p>ูุธุงู ุงููุฑุงุฌุนุฉ ุงูุฐููุฉ ููุซุงูููุฉ ุงูุนุงูุฉ</p>
            </div>

            <div id="authMessage"></div>

            <div id="loginForm">
                <div class="form-group">
                    <label>ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</label>
                    <input type="email" id="loginEmail" placeholder="example@email.com">
                </div>
                <div class="form-group">
                    <label>ูููุฉ ุงููุฑูุฑ</label>
                    <input type="password" id="loginPassword" placeholder="โขโขโขโขโขโขโขโข">
                </div>
                <button class="btn" onclick="login()">ุชุณุฌูู ุงูุฏุฎูู</button>
                <button class="btn btn-secondary" onclick="loginWithGoogle()" style="display: flex; align-items: center; justify-content: center; gap: 10px;">
                    <svg width="18" height="18" viewBox="0 0 48 48" fill="none">
                        <path d="M47.532 24.5528C47.532 22.9214 47.3997 21.2811 47.1175 19.6761H24.48V28.9181H37.4434C36.9055 31.8988 35.177 34.5356 32.6461 36.2111V42.2078H40.3801C44.9217 38.0278 47.532 31.8547 47.532 24.5528Z" fill="#4285F4"/>
                        <path d="M24.48 48.0016C30.9529 48.0016 36.4116 45.8764 40.3888 42.2078L32.6549 36.2111C30.5031 37.675 27.7252 38.5039 24.4888 38.5039C18.2275 38.5039 12.9187 34.2798 11.0139 28.6006H3.03296V34.7825C7.10718 42.8868 15.4056 48.0016 24.48 48.0016Z" fill="#34A853"/>
                        <path d="M11.0051 28.6006C9.99973 25.6199 9.99973 22.3922 11.0051 19.4115V13.2296H3.03298C-0.371021 20.0112 -0.371021 28.0009 3.03298 34.7825L11.0051 28.6006Z" fill="#FBBC04"/>
                        <path d="M24.48 9.49932C27.9016 9.44641 31.2086 10.7339 33.6866 13.0973L40.5387 6.24523C36.2 2.17101 30.4414 -0.068932 24.48 0.00161733C15.4055 0.00161733 7.10718 5.11644 3.03296 13.2296L11.005 19.4115C12.901 13.7235 18.2187 9.49932 24.48 9.49932Z" fill="#EA4335"/>
                    </svg>
                    ุชุณุฌูู ุงูุฏุฎูู ุจูุงุณุทุฉ Google
                </button>
                <a href="#" class="text-link" onclick="showRegister(); return false;">ููุณ ูุฏูู ุญุณุงุจุ ุณุฌู ุงูุขู</a>
            </div>

            <div id="registerForm" class="hidden">
                <div class="form-group">
                    <label>ุงูุงุณู</label>
                    <input type="text" id="registerName" placeholder="ุฃุฏุฎู ุงุณูู">
                </div>
                <div class="form-group">
                    <label>ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</label>
                    <input type="email" id="registerEmail" placeholder="example@email.com">
                </div>
                <div class="form-group">
                    <label>ูููุฉ ุงููุฑูุฑ</label>
                    <input type="password" id="registerPassword" placeholder="โขโขโขโขโขโขโขโข">
                </div>
                <button class="btn" onclick="register()">ุฅูุดุงุก ุญุณุงุจ</button>
                <button class="btn btn-secondary" onclick="loginWithGoogle()" style="display: flex; align-items: center; justify-content: center; gap: 10px;">
                    <svg width="18" height="18" viewBox="0 0 48 48" fill="none">
                        <path d="M47.532 24.5528C47.532 22.9214 47.3997 21.2811 47.1175 19.6761H24.48V28.9181H37.4434C36.9055 31.8988 35.177 34.5356 32.6461 36.2111V42.2078H40.3801C44.9217 38.0278 47.532 31.8547 47.532 24.5528Z" fill="#4285F4"/>
                        <path d="M24.48 48.0016C30.9529 48.0016 36.4116 45.8764 40.3888 42.2078L32.6549 36.2111C30.5031 37.675 27.7252 38.5039 24.4888 38.5039C18.2275 38.5039 12.9187 34.2798 11.0139 28.6006H3.03296V34.7825C7.10718 42.8868 15.4056 48.0016 24.48 48.0016Z" fill="#34A853"/>
                        <path d="M11.0051 28.6006C9.99973 25.6199 9.99973 22.3922 11.0051 19.4115V13.2296H3.03298C-0.371021 20.0112 -0.371021 28.0009 3.03298 34.7825L11.0051 28.6006Z" fill="#FBBC04"/>
                        <path d="M24.48 9.49932C27.9016 9.44641 31.2086 10.7339 33.6866 13.0973L40.5387 6.24523C36.2 2.17101 30.4414 -0.068932 24.48 0.00161733C15.4055 0.00161733 7.10718 5.11644 3.03296 13.2296L11.005 19.4115C12.901 13.7235 18.2187 9.49932 24.48 9.49932Z" fill="#EA4335"/>
                    </svg>
                    ุชุณุฌูู ุจูุงุณุทุฉ Google
                </button>
                <a href="#" class="text-link" onclick="showLogin(); return false;">ูุฏูู ุญุณุงุจุ ุณุฌู ุงูุฏุฎูู</a>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div id="mainApp" class="hidden">
        <div class="header">
            <div class="header-content">
                <h2 id="headerTitle">MOSTAFA THANAWEIA AMMA</h2>
                <div class="user-info">
                    <span class="user-email" id="userEmail"></span>
                    <button class="btn-logout" onclick="logout()">ุชุณุฌูู ุงูุฎุฑูุฌ</button>
                </div>
            </div>
        </div>

        <div class="container">
            <!-- Navigation Tabs -->
            <div class="nav-tabs">
                <button class="nav-tab active" onclick="showTab('home')">ุงูุฑุฆูุณูุฉ</button>
                <button class="nav-tab" onclick="showTab('add')">ุฅุถุงูุฉ ุณุคุงู</button>
                <button class="nav-tab" onclick="showTab('review')">ุงููุฑุงุฌุนุฉ</button>
                <button class="nav-tab" onclick="showTab('gallery')">ูุนุฑุถ ุงูุฃุณุฆูุฉ</button>
                <button class="nav-tab" onclick="showTab('stats')">ุงูุฅุญุตุงุฆูุงุช</button>
            </div>

            <!-- Home Tab -->
            <div id="homeTab" class="tab-content">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="totalQuestions">0</div>
                        <div class="stat-label">ุฅุฌูุงูู ุงูุฃุณุฆูุฉ</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="todayReview">0</div>
                        <div class="stat-label">ูุฑุงุฌุนุฉ ุงูููู</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="errorCount">0</div>
                        <div class="stat-label">ุฃุณุฆูุฉ ุงูุฃุฎุทุงุก</div>
                    </div>
                </div>

                <div class="card">
                    <h3>ูุธุฑุฉ ุนุงูุฉ</h3>
                    <p style="color: var(--text-secondary); margin-bottom: 15px;">
                        ูุฑุญุจุงู ุจู ูู ูุธุงู ุงููุฑุงุฌุนุฉ ุงูุฐููุฉ! ูุณุชุฎุฏู ุงูุชุทุจูู ูุธุงู ุงูุชูุฑุงุฑ ุงููุชุจุงุนุฏ ูุชุญุณูู ุญูุธู ููุฑุงุฌุนุชู.
                    </p>
                    <div id="subjectDistribution"></div>
                </div>
            </div>

            <!-- Add Question Tab -->
            <div id="addTab" class="tab-content hidden">
                <div class="card">
                    <h3>ุฅุถุงูุฉ ุณุคุงู ุฌุฏูุฏ</h3>
                    
                    <div style="margin-bottom: 20px; padding: 15px; background: var(--bg-tertiary); border-radius: 10px;">
                        <div style="display: flex; gap: 10px; margin-bottom: 10px; flex-wrap: wrap;">
                            <button class="btn" onclick="captureImage()" style="flex: 1; min-width: 200px; display: flex; align-items: center; justify-content: center; gap: 8px;">
                                ๐ธ ุงูุชูุท ุตูุฑุฉ ุงูุณุคุงู
                            </button>
                            <button class="btn btn-secondary" onclick="uploadImage()" style="flex: 1; min-width: 200px; display: flex; align-items: center; justify-content: center; gap: 8px;">
                                ๐ผ๏ธ ุฑูุน ุตูุฑุฉ
                            </button>
                        </div>
                        <input type="file" id="imageInput" accept="image/*" capture="environment" style="display: none;" onchange="handleImageSelect(event)">
                        <input type="file" id="uploadInput" accept="image/*" style="display: none;" onchange="handleImageSelect(event)">
                        
                        <div id="imagePreview" class="hidden" style="margin-top: 15px; text-align: center;">
                            <img id="previewImg" style="max-width: 100%; border-radius: 8px; margin-bottom: 10px; cursor: pointer;" onclick="openImageEditor()">
                            <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
                                <button class="btn-small" style="background: var(--accent); color: white;" onclick="openImageEditor()">โ๏ธ ุชุนุฏูู ุงูุตูุฑุฉ</button>
                                <button class="btn-small btn-danger" onclick="removeImage()">๐๏ธ ุญุฐู ุงูุตูุฑุฉ</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>ูุต ุงูุณุคุงู (ุงุฎุชูุงุฑู ุฅุฐุง ูุงูุช ููุงู ุตูุฑุฉ)</label>
                        <textarea id="questionText" placeholder="ุฃุฏุฎู ุงูุณุคุงู ููุง... ุฃู ุงุชุฑู ูุงุฑุบุงู ุฅุฐุง ูุงูุช ุงูุตูุฑุฉ ุชุญุชูู ุนูู ูู ุงูุชูุงุตูู"></textarea>
                    </div>

                    <div class="form-group">
                        <label style="display: flex; align-items: center; gap: 10px;">
                            <input type="checkbox" id="hasChoices" onchange="toggleChoices()" style="width: auto; cursor: pointer;">
                            <span>ุงูุณุคุงู ูุญุชูู ุนูู ุงุฎุชูุงุฑุงุช (MCQ)</span>
                        </label>
                    </div>

                    <div id="choicesContainer" class="hidden" style="margin-bottom: 20px; padding: 15px; background: var(--bg-tertiary); border-radius: 10px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <label style="margin: 0; font-weight: 600; color: var(--accent);">ุงูุงุฎุชูุงุฑุงุช</label>
                            <button type="button" class="btn-small" onclick="addChoice()" style="background: var(--success); color: white;">+ ุฅุถุงูุฉ ุงุฎุชูุงุฑ</button>
                        </div>
                        
                        <div id="choicesList">
                            <div class="choice-item" data-index="0">
                                <div style="display: flex; gap: 10px; align-items: start; margin-bottom: 10px;">
                                    <input type="radio" name="correctChoice" value="0" style="margin-top: 12px; cursor: pointer;">
                                    <input type="text" class="choice-input" placeholder="ุงูุงุฎุชูุงุฑ ุฃ" style="flex: 1; padding: 10px; background: var(--bg-primary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary);">
                                    <button type="button" class="btn-small btn-danger" onclick="removeChoice(0)" style="padding: 8px 12px;">ร</button>
                                </div>
                            </div>
                            <div class="choice-item" data-index="1">
                                <div style="display: flex; gap: 10px; align-items: start; margin-bottom: 10px;">
                                    <input type="radio" name="correctChoice" value="1" style="margin-top: 12px; cursor: pointer;">
                                    <input type="text" class="choice-input" placeholder="ุงูุงุฎุชูุงุฑ ุจ" style="flex: 1; padding: 10px; background: var(--bg-primary); border: 1px solid var(--border); border-radius: 6px; color: var(--text-primary);">
                                    <button type="button" class="btn-small btn-danger" onclick="removeChoice(1)" style="padding: 8px 12px;">ร</button>
                                </div>
                            </div>
                        </div>
                        
                        <div style="margin-top: 10px; padding: 10px; background: rgba(59, 130, 246, 0.1); border-radius: 6px; font-size: 13px; color: var(--text-secondary);">
                            ๐ก ุงุฎุชุฑ ุงูุฏุงุฆุฑุฉ ุจุฌุงูุจ ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>ุงููุงุฏุฉ</label>
                        <select id="questionSubject" onchange="loadChapters()">
                            <option value="">ุงุฎุชุฑ ุงููุงุฏุฉ</option>
                            <option value="ุฃุญูุงุก">ุฃุญูุงุก</option>
                            <option value="ุฌููููุฌูุง">ุฌููููุฌูุง</option>
                            <option value="ููููุงุก">ููููุงุก</option>
                            <option value="ููุฒูุงุก">ููุฒูุงุก</option>
                            <option value="ุฑูุงุถุฉ">ุฑูุงุถุฉ</option>
                            <option value="ุนุฑุจู">ุนุฑุจู</option>
                            <option value="ุฅูุฌููุฒู">ุฅูุฌููุฒู</option>
                        </select>
                    </div>

                    <div class="form-group" id="chapterGroup" style="display: none;">
                        <label style="display: flex; justify-content: space-between; align-items: center;">
                            <span>ุงูุจุงุจ/ุงููุตู</span>
                            <div style="display: flex; gap: 5px;">
                                <button type="button" class="btn-small" onclick="showAddChapterModal()" style="background: var(--gradient-3); color: white; padding: 6px 12px;">+ ุฅุถุงูุฉ ุจุงุจ</button>
                                <button type="button" class="btn-small" onclick="showManageChaptersModal()" style="background: var(--gradient-2); color: white; padding: 6px 12px;">โ๏ธ ุฅุฏุงุฑุฉ ุงูุฃุจูุงุจ</button>
                            </div>
                        </label>
                        <select id="questionChapter">
                            <option value="">ุงุฎุชุฑ ุงูุจุงุจ</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>ููุน ุงูุณุคุงู</label>
                        <select id="questionType">
                            <option value="ููู">ููู</option>
                            <option value="ุฎุทุฃ">ุฎุทุฃ</option>
                        </select>
                    </div>
                    <button class="btn" onclick="addQuestion()">๐พ ุฅุถุงูุฉ ุงูุณุคุงู</button>
                </div>
            </div>

            <!-- Review Tab -->
            <div id="reviewTab" class="tab-content hidden">
                <div class="review-container">
                    <div class="swipe-progress" id="swipeProgress" style="display: none;">
                        <div class="swipe-progress-item correct">
                            <span>โ</span>
                            <span id="correctCount">0</span>
                        </div>
                        <div class="swipe-progress-item remaining">
                            <span>๐</span>
                            <span id="remainingCount">0</span>
                        </div>
                        <div class="swipe-progress-item wrong">
                            <span>โ</span>
                            <span id="wrongCount">0</span>
                        </div>
                    </div>

                    <div id="reviewContent" class="review-card">
                        <div class="loading">
                            <div class="spinner"></div>
                            <p style="margin-top: 15px; color: var(--text-secondary);">ุฌุงุฑู ุชุญููู ุงูุฃุณุฆูุฉ...</p>
                        </div>
                    </div>

                    <div class="swipe-hint" id="swipeHint" style="display: none;">
                        <div class="swipe-hint-item">
                            <span>๐</span>
                            <span>ุงุณุญุจ ูุณุงุฑ = ุบูุทุช</span>
                        </div>
                        <div class="swipe-hint-item">
                            <span>๐</span>
                            <span>ุงุณุญุจ ุฃุนูู = ุชุฎุทู</span>
                        </div>
                        <div class="swipe-hint-item">
                            <span>๐</span>
                            <span>ุงุณุญุจ ูููู = ุฃุชููุชู</span>
                        </div>
                    </div>

                    <div class="swipe-actions" id="swipeActions" style="display: none;">
                        <button class="swipe-btn swipe-btn-wrong" onclick="handleSwipeAction('wrong')" title="ุบูุทุช">
                            โ
                        </button>
                        <button class="swipe-btn swipe-btn-skip" onclick="handleSwipeAction('skip')" title="ุชุฎุทู">
                            โญ๏ธ
                        </button>
                        <button class="swipe-btn swipe-btn-correct" onclick="handleSwipeAction('correct')" title="ุฃุชููุชู">
                            โ
                        </button>
                    </div>
                </div>
            </div>

            <!-- Gallery Tab -->
            <div id="galleryTab" class="tab-content hidden">
                <div class="card">
                    <h3>๐จ ูุนุฑุถ ุงูุฃุณุฆูุฉ</h3>
                    
                    <div style="margin-bottom: 20px;">
                        <div class="subject-filter">
                            <button class="filter-btn active" onclick="filterQuestions('all')">ุงููู</button>
                            <button class="filter-btn" onclick="filterQuestions('ุฃุญูุงุก')">ุฃุญูุงุก</button>
                            <button class="filter-btn" onclick="filterQuestions('ุฌููููุฌูุง')">ุฌููููุฌูุง</button>
                            <button class="filter-btn" onclick="filterQuestions('ููููุงุก')">ููููุงุก</button>
                            <button class="filter-btn" onclick="filterQuestions('ููุฒูุงุก')">ููุฒูุงุก</button>
                            <button class="filter-btn" onclick="filterQuestions('ุฑูุงุถุฉ')">ุฑูุงุถุฉ</button>
                            <button class="filter-btn" onclick="filterQuestions('ุนุฑุจู')">ุนุฑุจู</button>
                            <button class="filter-btn" onclick="filterQuestions('ุฅูุฌููุฒู')">ุฅูุฌููุฒู</button>
                        </div>

                        <div id="chapterFilterGroup" class="hidden" style="margin-top: 15px;">
                            <label style="display: block; margin-bottom: 10px; color: var(--text-secondary); font-size: 14px; font-weight: 600;">ุชุตููุฉ ุญุณุจ ุงูุจุงุจ:</label>
                            <div id="chapterFilterButtons" class="subject-filter">
                                <!-- Will be populated dynamically -->
                            </div>
                        </div>
                    </div>

                    <div id="galleryList">
                        <div class="loading">
                            <div class="spinner"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Stats Tab -->
            <div id="statsTab" class="tab-content hidden">
                <div class="card">
                    <h3>๐ ุฅุญุตุงุฆูุงุช ุชูุตูููุฉ</h3>
                    <div id="detailedStats">
                        <div class="loading">
                            <div class="spinner"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bottom Navigation (Mobile) -->
        <div class="bottom-nav">
            <div class="bottom-nav-content">
                <button class="bottom-nav-item active" onclick="showTab('home')">ุงูุฑุฆูุณูุฉ</button>
                <button class="bottom-nav-item" onclick="showTab('add')">ุฅุถุงูุฉ</button>
                <button class="bottom-nav-item" onclick="showTab('review')">ูุฑุงุฌุนุฉ</button>
                <button class="bottom-nav-item" onclick="showTab('gallery')">ุงููุนุฑุถ</button>
                <button class="bottom-nav-item" onclick="showTab('stats')">ุฅุญุตุงุฆูุงุช</button>
            </div>
        </div>
    </div>

    <!-- PWA Install Prompt -->
    <div id="installPrompt" class="install-prompt hidden">
        <div class="install-prompt-header">
            <div class="install-prompt-icon">๐</div>
            <div>
                <div class="install-prompt-title">ุซุจูุช ุงูุชุทุจูู</div>
                <div class="install-prompt-desc">
                    ุงุญุตู ุนูู ุชุฌุฑุจุฉ ุฃูุถู! ุซุจูุช ุงูุชุทุจูู ูููุตูู ุงูุณุฑูุน ูุงููุฑุงุฌุนุฉ ุจุฏูู ุงุชุตุงู
                </div>
            </div>
        </div>
        <div class="install-prompt-actions">
            <button class="install-btn-primary" onclick="installApp()">
                ๐ฅ ุชุซุจูุช ุงูุขู
            </button>
            <button class="install-btn-secondary" onclick="dismissInstallPrompt()">
                ูุงุญูุงู
            </button>
        </div>
    </div>

    <!-- Note Modal -->
    <div id="noteModal" class="modal-overlay hidden" onclick="closeNoteModal(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h3>โ๏ธ ููุงุญุธุฉ ุนูู ุงูุณุคุงู</h3>
                <button class="modal-close" onclick="closeNoteModal()">ร</button>
            </div>
            <div class="form-group">
                <label>ุงูุณุคุงู</label>
                <div id="modalQuestionText" style="padding: 12px; background: var(--bg-tertiary); border-radius: 8px; margin-bottom: 15px; color: var(--text-secondary); font-size: 14px;"></div>
            </div>
            
            <div style="margin-bottom: 15px;">
                <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                    <button class="btn-small" onclick="switchNoteType('text')" id="noteTypeText" style="flex: 1; background: var(--accent); color: white;">๐ ูุต</button>
                    <button class="btn-small" onclick="switchNoteType('voice')" id="noteTypeVoice" style="flex: 1; background: var(--bg-tertiary); color: var(--text-secondary);">๐ค ุตูุช</button>
                </div>
            </div>

            <div id="textNoteSection">
                <div class="form-group">
                    <label>ุงูููุงุญุธุฉ</label>
                    <textarea id="noteInput" placeholder="ุงูุชุจ ููุงุญุธุชู ููุง..." style="min-height: 150px;"></textarea>
                </div>
            </div>

            <div id="voiceNoteSection" class="hidden">
                <div class="voice-recorder">
                    <div class="voice-recorder-controls">
                        <button class="btn btn-success" onclick="startRecording()" id="startRecordBtn">
                            ๐ค ุงุจุฏุฃ ุงูุชุณุฌูู
                        </button>
                        <button class="record-btn record-btn-stop hidden" onclick="stopRecording()" id="stopRecordBtn">
                            โน๏ธ ุฅููุงู
                        </button>
                        <div class="recording-indicator hidden" id="recordingIndicator">
                            <div class="recording-dot"></div>
                            <span id="recordingTime">00:00</span>
                        </div>
                    </div>
                    <div id="audioPlaybackSection" class="hidden" style="margin-top: 15px;">
                        <div id="customAudioPlayerContainer"></div>
                        <button class="btn-small btn-danger" onclick="deleteVoiceNote()" style="margin-top: 10px; width: 100%;">๐๏ธ ุญุฐู ุงูุชุณุฌูู</button>
                    </div>
                </div>
            </div>

            <div style="display: flex; gap: 10px; margin-top: 20px;">
                <button class="btn btn-success" onclick="saveNote()" style="flex: 1;">๐พ ุญูุธ ุงูููุงุญุธุฉ</button>
                <button class="btn btn-secondary" onclick="closeNoteModal()" style="flex: 1;">ุฅูุบุงุก</button>
            </div>
        </div>
    </div>

    <!-- Image Editor Modal -->
    <div id="imageEditorModal" class="image-editor-overlay hidden">
        <div class="image-editor-header">
            <div class="image-editor-title">โ๏ธ ุชุนุฏูู ุงูุตูุฑุฉ</div>
            <button class="image-editor-close" onclick="closeImageEditor()">ุฅูุบุงุก</button>
        </div>
        <div class="image-editor-canvas-container">
            <canvas id="editorCanvas"></canvas>
        </div>
        <div class="image-editor-tools">
            <button class="image-editor-btn image-editor-btn-secondary" onclick="cropImage()">
                โ๏ธ ูุต ุงูุตูุฑุฉ
            </button>
            <button class="image-editor-btn image-editor-btn-secondary" onclick="rotateImage()">
                ๐ ุชุฏููุฑ
            </button>
            <button class="image-editor-btn image-editor-btn-primary" onclick="saveEditedImage()">
                โ ุญูุธ ุงูุชุนุฏููุงุช
            </button>
        </div>
    </div>

    <!-- Add Chapter Modal -->
    <div id="addChapterModal" class="modal-overlay hidden" onclick="closeAddChapterModal(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h3>โ ุฅุถุงูุฉ ุจุงุจ ุฌุฏูุฏ</h3>
                <button class="modal-close" onclick="closeAddChapterModal()">ร</button>
            </div>
            <div class="form-group">
                <label>ุงุณู ุงูุจุงุจ</label>
                <input type="text" id="newChapterName" placeholder="ูุซุงู: ุงูุจุงุจ ุงูุฃูู - ุงูุฎููุฉ">
            </div>
            <div style="display: flex; gap: 10px;">
                <button class="btn btn-success" onclick="saveNewChapter()" style="flex: 1;">โ ุฅุถุงูุฉ</button>
                <button class="btn btn-secondary" onclick="closeAddChapterModal()" style="flex: 1;">ุฅูุบุงุก</button>
            </div>
        </div>
    </div>

    <!-- Manage Chapters Modal -->
    <div id="manageChaptersModal" class="modal-overlay hidden" onclick="closeManageChaptersModal(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h3>โ๏ธ ุฅุฏุงุฑุฉ ุงูุฃุจูุงุจ</h3>
                <button class="modal-close" onclick="closeManageChaptersModal()">ร</button>
            </div>
            <div id="chaptersListManage">
                <div class="loading">
                    <div class="spinner"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Chapter Modal -->
    <div id="editChapterModal" class="modal-overlay hidden" onclick="closeEditChapterModal(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h3>โ๏ธ ุชุนุฏูู ุงูุจุงุจ</h3>
                <button class="modal-close" onclick="closeEditChapterModal()">ร</button>
            </div>
            <div class="form-group">
                <label>ุงุณู ุงูุจุงุจ</label>
                <input type="text" id="editChapterName" placeholder="ูุซุงู: ุงูุจุงุจ ุงูุฃูู - ุงูุฎููุฉ">
            </div>
            <div style="display: flex; gap: 10px;">
                <button class="btn btn-success" onclick="updateChapter()" style="flex: 1;">โ ุญูุธ</button>
                <button class="btn btn-secondary" onclick="closeEditChapterModal()" style="flex: 1;">ุฅูุบุงุก</button>
            </div>
        </div>
    </div>

    <!-- Image Fullscreen View -->
    <div id="imageFullscreen" class="image-fullscreen hidden" onclick="closeFullscreenImage()">
        <button class="image-fullscreen-close" onclick="closeFullscreenImage()">ร</button>
        <img id="fullscreenImg" src="">
    </div>

    <!-- Firebase Scripts -->
    <script src="https://www.gstatic.com/firebasejs/12.7.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/12.7.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore-compat.js"></script>
    <script  src="main.js"></script>

</body>
</html>